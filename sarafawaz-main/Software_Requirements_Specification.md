# Software Requirements Specification (SRS)
# وثيقة متطلبات البرمجيات

## نظام سارة لإدارة الحضور والموارد البشرية
### Sara Attendance & HRM System

**الإصدار:** 1.0  
**التاريخ:** ديسمبر 2024  
**المؤسسة:** مستشفى الملك خالد - حائل

---

## جدول المحتويات

1. [مقدمة](#1-مقدمة)
2. [الغرض والأهداف](#2-الغرض-والأهداف)
3. [أصحاب المصلحة (Stakeholders)](#3-أصحاب-المصلحة-stakeholders)
4. [المتطلبات الوظيفية (Functional Requirements)](#4-المتطلبات-الوظيفية-functional-requirements)
5. [المتطلبات غير الوظيفية (Non-functional Requirements)](#5-المتطلبات-غير-الوظيفية-non-functional-requirements)
6. [متطلبات النظام (System Requirements)](#6-متطلبات-النظام-system-requirements)
7. [القيود (Constraints)](#7-القيود-constraints)
8. [الافتراضات والاعتماديات](#8-الافتراضات-والاعتماديات)

---

## 1. مقدمة

### 1.1 نظرة عامة
نظام سارة هو نظام إلكتروني متكامل لإدارة الحضور والانصراف والموارد البشرية، مصمم خصيصاً لمستشفى الملك خالد في حائل. يوفر النظام واجهة عربية بتصميم RTL (من اليمين لليسار) مع التركيز على الأمان والموثوقية.

### 1.2 نطاق المشروع
يغطي النظام:
- تسجيل حضور وانصراف المتدربين
- التحقق من الموقع الجغرافي (GPS)
- ربط الأجهزة (Device Fingerprint)
- إدارة الأقسام والمواقع المصرح بها
- إنشاء التقارير وتصديرها
- إدارة طلبات تغيير الأجهزة

### 1.3 الجمهور المستهدف
- المتدربون (Trainees)
- المشرفون (Supervisors)
- المدراء (Managers)
- فريق تقنية المعلومات

### 1.4 المصطلحات والاختصارات

| المصطلح | التعريف |
|---------|---------|
| GPS | نظام تحديد المواقع العالمي |
| RTL | اتجاه النص من اليمين لليسار |
| HRM | إدارة الموارد البشرية |
| متدرب | المستخدم الذي يسجل الحضور والانصراف |
| Device Fingerprint | بصمة الجهاز الفريدة للتعريف |

---

## 2. الغرض والأهداف

### 2.1 الغرض من النظام
استبدال نظام الحضور التقليدي بنظام إلكتروني آمن يعتمد على:
- التحقق من الموقع الجغرافي
- ربط كل متدرب بجهاز واحد فقط
- توفير تقارير دقيقة وفورية

### 2.2 الأهداف الرئيسية

| # | الهدف | المؤشر |
|---|-------|--------|
| 1 | أتمتة عملية الحضور | تقليل وقت التسجيل بنسبة 80% |
| 2 | منع التلاعب | التحقق من الموقع والجهاز |
| 3 | تسهيل إدارة التقارير | تصدير PDF و Excel |
| 4 | دعم اللغة العربية | واجهة RTL كاملة |
| 5 | سهولة الاستخدام | تصميم بسيط وواضح |

### 2.3 الحاجة للمشروع (Problem Statement)

**المشكلة الحالية:**
- صعوبة متابعة حضور المتدربين يدوياً
- احتمالية التلاعب في سجلات الحضور
- عدم وجود تقارير فورية ودقيقة
- صعوبة التحقق من تواجد المتدرب في الموقع الفعلي

**الحل المقترح:**
نظام إلكتروني يتحقق من:
1. هوية المتدرب عبر تسجيل الدخول
2. الموقع الجغرافي عبر GPS
3. الجهاز المستخدم عبر Device Fingerprint

---

## 3. أصحاب المصلحة (Stakeholders)

### 3.1 المتدربون (Trainees)
**الوصف:** الموظفون المتدربون الذين يسجلون حضورهم يومياً

**الصلاحيات:**
- تسجيل الحضور والانصراف
- عرض سجل الحضور الشخصي
- تسجيل الجهاز الشخصي
- طلب تغيير الجهاز

**الاحتياجات:**
- واجهة سهلة وسريعة
- معرفة حالة الحضور الحالية
- عرض الإحصائيات الشخصية

### 3.2 المشرفون (Supervisors)
**الوصف:** المسؤولون عن إدارة قسم معين

**الصلاحيات:**
- جميع صلاحيات المتدرب
- إدارة المواقع المصرح بها للقسم
- إدارة جداول العمل للقسم
- الموافقة على طلبات تغيير الأجهزة
- عرض تقارير القسم
- إدارة متدربي القسم

**الاحتياجات:**
- رؤية شاملة لحضور القسم
- أدوات إدارة سهلة
- تقارير مفصلة

### 3.3 المدراء (Managers)
**الوصف:** الإدارة العليا مع صلاحيات كاملة

**الصلاحيات:**
- جميع صلاحيات المشرف
- إدارة جميع الأقسام
- إدارة المستخدمين والصلاحيات
- إدارة المواقع العامة
- عرض التقارير الشاملة
- إعدادات النظام

**الاحتياجات:**
- نظرة شاملة على المؤسسة
- تقارير إحصائية متقدمة
- تحكم كامل بالنظام

### 3.4 جدول الصلاحيات

| الميزة | متدرب | مشرف | مدير |
|--------|-------|------|------|
| تسجيل حضور/انصراف | ✅ | ✅ | ✅ |
| عرض السجل الشخصي | ✅ | ✅ | ✅ |
| تسجيل الجهاز | ✅ | ✅ | ✅ |
| طلب تغيير الجهاز | ✅ | ✅ | ✅ |
| إدارة مواقع القسم | ❌ | ✅ | ✅ |
| إدارة جداول القسم | ❌ | ✅ | ✅ |
| الموافقة على الطلبات | ❌ | ✅ (قسمه) | ✅ (الكل) |
| تقارير القسم | ❌ | ✅ | ✅ |
| إدارة الأقسام | ❌ | ❌ | ✅ |
| إدارة المستخدمين | ❌ | ❌ | ✅ |
| المواقع العامة | ❌ | ❌ | ✅ |
| إعدادات النظام | ❌ | ❌ | ✅ |

---

## 4. المتطلبات الوظيفية (Functional Requirements)

### 4.1 إدارة المستخدمين (User Management)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-UM-01 | تسجيل الدخول | عالية | يجب أن يتمكن المستخدم من تسجيل الدخول باسم المستخدم وكلمة المرور |
| FR-UM-02 | تسجيل الخروج | عالية | يجب أن يتمكن المستخدم من تسجيل الخروج بشكل آمن |
| FR-UM-03 | إضافة مستخدم | عالية | يجب أن يتمكن المدير من إضافة مستخدمين جدد |
| FR-UM-04 | تعديل مستخدم | متوسطة | يجب أن يتمكن المدير من تعديل بيانات المستخدمين |
| FR-UM-05 | تعيين الصلاحيات | عالية | يجب أن يتمكن المدير من تعيين دور المستخدم (متدرب/مشرف/مدير) |
| FR-UM-06 | تعيين القسم | عالية | يجب أن يتمكن المدير من ربط المستخدم بقسم معين |

### 4.2 تسجيل الحضور (Attendance Recording)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-AT-01 | تسجيل الحضور | عالية | يجب أن يتمكن المتدرب من تسجيل حضوره |
| FR-AT-02 | تسجيل الانصراف | عالية | يجب أن يتمكن المتدرب من تسجيل انصرافه |
| FR-AT-03 | التحقق من GPS | عالية | يجب التحقق من الموقع الجغرافي قبل التسجيل |
| FR-AT-04 | التحقق من الجهاز | عالية | يجب التحقق من بصمة الجهاز المسجل |
| FR-AT-05 | حساب ساعات العمل | متوسطة | يجب حساب ساعات العمل تلقائياً |
| FR-AT-06 | عرض الحالة | عالية | يجب عرض حالة الحضور الحالية للمتدرب |
| FR-AT-07 | منع التسجيل المزدوج | عالية | يجب منع تسجيل الحضور مرتين متتاليتين |

### 4.3 إدارة الأجهزة (Device Management)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-DV-01 | تسجيل الجهاز | عالية | يجب أن يتمكن المتدرب من تسجيل جهازه |
| FR-DV-02 | جهاز واحد فقط | عالية | يجب السماح بجهاز واحد فقط لكل متدرب |
| FR-DV-03 | طلب تغيير الجهاز | عالية | يجب أن يتمكن المتدرب من طلب تغيير جهازه |
| FR-DV-04 | الموافقة على الطلب | عالية | يجب أن يتمكن المشرف/المدير من الموافقة أو الرفض |
| FR-DV-05 | تشفير البصمة | عالية | يجب تشفير بصمة الجهاز (AES-256) |

### 4.4 إدارة المواقع (Location Management)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-LC-01 | إضافة موقع | عالية | يجب أن يتمكن المشرف/المدير من إضافة مواقع مصرح بها |
| FR-LC-02 | تحديد الإحداثيات | عالية | يجب تحديد خط العرض والطول للموقع |
| FR-LC-03 | تحديد النطاق | عالية | يجب تحديد نطاق الموقع بالأمتار |
| FR-LC-04 | ربط بالقسم | متوسطة | يمكن ربط الموقع بقسم معين أو جعله عاماً |
| FR-LC-05 | تفعيل/تعطيل الموقع | متوسطة | يجب أن يتمكن المدير من تفعيل أو تعطيل الموقع |
| FR-LC-06 | الخريطة التفاعلية | متوسطة | يجب توفير خريطة لاختيار الموقع |

### 4.5 إدارة الأقسام (Department Management)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-DP-01 | إضافة قسم | عالية | يجب أن يتمكن المدير من إضافة أقسام جديدة |
| FR-DP-02 | تعديل قسم | متوسطة | يجب أن يتمكن المدير من تعديل بيانات القسم |
| FR-DP-03 | حذف قسم | منخفضة | يجب أن يتمكن المدير من حذف القسم (إذا كان فارغاً) |
| FR-DP-04 | عرض الأقسام | عالية | يجب عرض قائمة الأقسام مع عدد المتدربين |

### 4.6 التقارير (Reports)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-RP-01 | التقرير اليومي | عالية | عرض سجلات الحضور اليومية |
| FR-RP-02 | التقرير الشهري | عالية | عرض ملخص الحضور الشهري |
| FR-RP-03 | تصفية بالقسم | متوسطة | تصفية التقارير حسب القسم |
| FR-RP-04 | تصفية بالتاريخ | عالية | تصفية التقارير حسب نطاق تاريخي |
| FR-RP-05 | تصدير PDF | عالية | تصدير التقرير بصيغة PDF |
| FR-RP-06 | تصدير Excel | عالية | تصدير التقرير بصيغة Excel |
| FR-RP-07 | الإحصائيات | متوسطة | عرض إحصائيات الحضور والتأخر والغياب |

### 4.7 جداول العمل (Work Schedules)

| معرف | المتطلب | الأولوية | الوصف |
|------|---------|----------|-------|
| FR-WS-01 | إضافة جدول | متوسطة | إضافة جدول عمل جديد |
| FR-WS-02 | تحديد أيام العمل | متوسطة | تحديد أيام الأسبوع للجدول |
| FR-WS-03 | تحديد الأوقات | متوسطة | تحديد وقت البدء والانتهاء |
| FR-WS-04 | ربط بالقسم | متوسطة | ربط الجدول بقسم معين |

---

## 5. المتطلبات غير الوظيفية (Non-functional Requirements)

### 5.1 الأمان (Security)

| معرف | المتطلب | الوصف |
|------|---------|-------|
| NFR-SC-01 | تشفير كلمات المرور | استخدام bcrypt لتشفير كلمات المرور |
| NFR-SC-02 | تشفير بصمة الجهاز | استخدام AES-256-CBC للتشفير |
| NFR-SC-03 | إدارة الجلسات | جلسات آمنة مع انتهاء صلاحية تلقائي |
| NFR-SC-04 | التحقق من الصلاحيات | التحقق من صلاحيات المستخدم قبل كل عملية |
| NFR-SC-05 | سجل المراجعة | تسجيل جميع العمليات الحساسة |
| NFR-SC-06 | HTTPS | استخدام اتصال مشفر |

### 5.2 الأداء (Performance)

| معرف | المتطلب | الوصف |
|------|---------|-------|
| NFR-PF-01 | وقت الاستجابة | أقل من 2 ثانية لمعظم العمليات |
| NFR-PF-02 | تحميل الصفحات | أقل من 3 ثواني للتحميل الأولي |
| NFR-PF-03 | دعم المستخدمين | دعم 100+ مستخدم متزامن |

### 5.3 قابلية الاستخدام (Usability)

| معرف | المتطلب | الوصف |
|------|---------|-------|
| NFR-US-01 | واجهة عربية | دعم كامل للغة العربية |
| NFR-US-02 | RTL | تصميم من اليمين لليسار |
| NFR-US-03 | تصميم متجاوب | يعمل على الجوال والكمبيوتر |
| NFR-US-04 | سهولة التعلم | واجهة بسيطة وواضحة |
| NFR-US-05 | رسائل واضحة | رسائل خطأ ونجاح واضحة |

### 5.4 الموثوقية (Reliability)

| معرف | المتطلب | الوصف |
|------|---------|-------|
| NFR-RL-01 | التوفر | النظام متاح 99% من الوقت |
| NFR-RL-02 | النسخ الاحتياطي | نسخ احتياطي يومي لقاعدة البيانات |
| NFR-RL-03 | استرداد البيانات | إمكانية استرداد البيانات عند الحاجة |

### 5.5 قابلية الصيانة (Maintainability)

| معرف | المتطلب | الوصف |
|------|---------|-------|
| NFR-MN-01 | كود نظيف | اتباع معايير البرمجة النظيفة |
| NFR-MN-02 | التوثيق | توثيق الكود والـ API |
| NFR-MN-03 | التحديث | سهولة تحديث النظام |

---

## 6. متطلبات النظام (System Requirements)

### 6.1 متطلبات الخادم (Server Requirements)

| المكون | المتطلب |
|--------|---------|
| نظام التشغيل | Linux (أي توزيعة) |
| المعالج | 2 cores minimum |
| الذاكرة | 2GB RAM minimum |
| التخزين | 10GB minimum |
| قاعدة البيانات | PostgreSQL 14+ |
| Node.js | v18+ |

### 6.2 متطلبات العميل (Client Requirements)

| المكون | المتطلب |
|--------|---------|
| المتصفح | Chrome 90+, Firefox 88+, Safari 14+, Edge 90+ |
| الشاشة | 320px minimum width |
| الإنترنت | اتصال مستقر |
| GPS | دعم Geolocation API |
| JavaScript | مفعّل |

### 6.3 التقنيات المستخدمة

**Frontend:**
| التقنية | الإصدار | الغرض |
|---------|---------|-------|
| React | 18.x | مكتبة واجهة المستخدم |
| TypeScript | 5.x | لغة البرمجة |
| Tailwind CSS | 3.x | التصميم |
| shadcn/ui | - | مكونات UI |
| TanStack Query | 5.x | إدارة البيانات |
| Wouter | 3.x | التنقل |
| FingerprintJS | 4.x | بصمة الجهاز |
| Pigeon Maps | 0.21.x | الخرائط |

**Backend:**
| التقنية | الإصدار | الغرض |
|---------|---------|-------|
| Node.js | 18.x | بيئة التشغيل |
| Express.js | 4.x | إطار الخادم |
| TypeScript | 5.x | لغة البرمجة |
| Drizzle ORM | - | إدارة قاعدة البيانات |
| bcryptjs | - | تشفير كلمات المرور |
| express-session | - | إدارة الجلسات |
| Zod | - | التحقق من البيانات |

**Database:**
| التقنية | الإصدار | الغرض |
|---------|---------|-------|
| PostgreSQL | 14+ | قاعدة البيانات الرئيسية |

### 6.4 نظام التشغيل
النظام يعمل على **جميع أنظمة التشغيل** لأنه تطبيق ويب (Web Application):
- Windows
- macOS
- Linux
- Android (متصفح)
- iOS (متصفح)

---

## 7. القيود (Constraints)

### 7.1 القيود التقنية

| القيد | الوصف |
|-------|-------|
| الاتصال بالإنترنت | يتطلب اتصال إنترنت مستقر |
| GPS | يتطلب تفعيل خدمة الموقع |
| المتصفح الحديث | لا يدعم المتصفحات القديمة |
| JavaScript | يجب تفعيل JavaScript |

### 7.2 القيود التشغيلية

| القيد | الوصف |
|-------|-------|
| جهاز واحد | كل متدرب يستخدم جهاز واحد فقط |
| نطاق الموقع | يجب التواجد ضمن النطاق المحدد |
| تغيير الجهاز | يتطلب موافقة المشرف |

### 7.3 القيود الزمنية

| القيد | الوصف |
|-------|-------|
| انتهاء الجلسة | تنتهي الجلسة بعد فترة عدم نشاط |
| تحديث البيانات | التحديث الفوري للحضور |

---

## 8. الافتراضات والاعتماديات

### 8.1 الافتراضات

1. المستخدمون لديهم أجهزة ذكية حديثة
2. المستخدمون لديهم اتصال إنترنت في موقع العمل
3. المستخدمون يوافقون على مشاركة موقعهم الجغرافي
4. الأقسام والمواقع محددة مسبقاً من الإدارة

### 8.2 الاعتماديات

1. **خدمة الاستضافة (Replit):** النظام مستضاف على منصة Replit
2. **قاعدة البيانات (PostgreSQL):** تعتمد على خدمة Neon Database
3. **خدمة GPS:** تعتمد على Geolocation API في المتصفح
4. **خدمة البصمة:** تعتمد على مكتبة FingerprintJS

---

## الملاحق

### ملحق أ: قائمة APIs

| Endpoint | Method | الوصف |
|----------|--------|-------|
| /api/auth/login | POST | تسجيل الدخول |
| /api/auth/logout | POST | تسجيل الخروج |
| /api/auth/user | GET | بيانات المستخدم الحالي |
| /api/attendance/check-in | POST | تسجيل الحضور |
| /api/attendance/check-out | POST | تسجيل الانصراف |
| /api/attendance/records | GET | سجلات الحضور |
| /api/attendance/my-status | GET | حالة الحضور الحالية |
| /api/users | GET/POST | إدارة المستخدمين |
| /api/departments | GET/POST | إدارة الأقسام |
| /api/allowed-locations | GET/POST/PATCH/DELETE | إدارة المواقع |
| /api/device-requests | GET/POST/PATCH | طلبات الأجهزة |
| /api/work-schedules | GET/POST/PATCH/DELETE | جداول العمل |
| /api/reports/* | GET | التقارير |

### ملحق ب: هيكل قاعدة البيانات

**الجداول الرئيسية:**
1. `users` - المستخدمين
2. `departments` - الأقسام
3. `attendance_records` - سجلات الحضور
4. `allowed_locations` - المواقع المصرح بها
5. `device_change_requests` - طلبات تغيير الأجهزة
6. `work_schedules` - جداول العمل
7. `audit_logs` - سجل المراجعة

---

**نهاية الوثيقة**

*إعداد: فريق تطوير نظام سارة*  
*التاريخ: ديسمبر 2024*
